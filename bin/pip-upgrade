#!/usr/bin/env bash

# Managed by Homebrew (or apt)
no_update=(
  basemap
  gdal
  numpy
  pillow
  pygame
  scipy
)

test "$1" = '-2' && pyversion=2
test "$1" = '-3' && pyversion=3

python_pip="python$pyversion -m pip"

no_grep="$(echo "${no_update[@]}" | perl -pe 's/ /|/g')"

packages="$(
  $python_pip list --outdated \
    | awk "NR > 2 && ! (tolower(\$1) ~ /$no_grep/) {print \$1}"
)"

for pkg in $packages; do
  $python_pip install --upgrade "$pkg"
done
